{\rtf1\ansi\ansicpg1252\cocoartf1561\cocoasubrtf400
{\fonttbl\f0\fswiss\fcharset0 ArialMT;\f1\froman\fcharset0 Times-Roman;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red16\green60\blue192;\red195\green73\blue13;
\red255\green255\blue255;\red251\green0\blue7;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;\cssrgb\c6667\c33333\c80000;\cssrgb\c81569\c36863\c4314;
\cssrgb\c100000\c100000\c100000;\cssrgb\c100000\c0\c0;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid2\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid3\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li2160\lin2160 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}}
\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 The purpose of this script is to remove identical or sequence similar at some percentage from a sequence file downloaded from GenBank.
\f1\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl400\partightenfactor0
\ls1\ilvl0
\f0\fs29\fsmilli14667 \cf2 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 The pipeline is composed of various scripts: Uniquify.py, rid_by_tree_water.py, WaterRids.py. \uc0\u8232 \
\ls1\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 All of them should be in the folder from where you run the script.\uc0\u8232 \
\ls1\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 The script need third party tools: you need to install \uc0\u8232 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sl400\partightenfactor0
\ls1\ilvl1\cf2 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 MAFFT ({\field{\*\fldinst{HYPERLINK "http://mafft.cbrc.jp/alignment/software/"}}{\fldrslt \cf3 \ul \ulc3 \strokec3 http://mafft.cbrc.jp/alignment/software/}})\uc0\u8232 \
\ls1\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 FastTree ({\field{\*\fldinst{HYPERLINK "http://www.microbesonline.org/fasttree/"}}{\fldrslt 
\fs28 \cf4 \cb5 \strokec4 www.microbesonline.org/fasttree}}. \'c2\'a0Download the link for the FastTree.c file you\'e2\'80\'99ll find on the page, THIS DOWNLOAD ONLY works in Safari. \'c2\'a0Follow the instructions to compile also found on the page)\uc0\u8232 \
\ls1\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 EMBOSS (ftp://{\field{\*\fldinst{HYPERLINK "http://emboss.open-bio.org/pub/EMBOSS/"}}{\fldrslt \cf3 \ul \ulc3 \strokec3 emboss.open-bio.org/pub/EMBOSS/}} \uc0\u8232 \
\pard\tx1660\tx2160\pardeftab720\li2160\fi-2160\sl400\partightenfactor0
\ls1\ilvl2\cf2 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9642 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Directions for installation here: {\field{\*\fldinst{HYPERLINK "http://emboss.sourceforge.net/download/"}}{\fldrslt \cf3 \ul \ulc3 \strokec3 http://emboss.sourceforge.net/download/}}\uc0\u8232 \
\ls1\ilvl2\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9642 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Download and extract with $ tar -xvf EMBOSS\cb5 x.x.tar.gz \cb1 \uc0\u8232 \
\pard\tx1660\tx2160\pardeftab720\li2160\fi-2160\sl400\partightenfactor0
\ls1\ilvl2\cf2 \cb5 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9642 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 $ ./configure [./compile (in previous version)] (you may get an error if you are missing X11 developer tools. \'c2\'a0Since X11 isn\'e2\'80\'99t available for newer Macs you will instead need to install the latest version of XQuartz ({\field{\*\fldinst{HYPERLINK "https://www.xquartz.org/"}}{\fldrslt \cf3 \ul \ulc3 \strokec3 https://www.xquartz.org/}}, remove the install and repeat configuration)\cb1 \uc0\u8232 \cb5 \
\ls1\ilvl2\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9642 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 $ make ($ make install [in previous version]) \cb1 \uc0\u8232 \cb5 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sl400\partightenfactor0
\ls1\ilvl1\cf2 \cb1 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Make sure they are all added to your bash path\uc0\u8232 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl400\partightenfactor0
\ls1\ilvl0\cf2 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 You must change the email address in the Uniquify.py file in the line 8: Entrez.email = 'jgrattepanche@smith.edu' \uc0\u8232 \
\pard\pardeftab720\sl280\partightenfactor0

\f1\fs24 \cf2 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2 You will also need a sequence file.
\f1\fs24 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\b\fs29\fsmilli14667 \cf2 Sequence file format:
\f1\b0\fs24 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2 The format is the format from a GenBank sequence: 
\f1\fs24 \

\f0\fs29\fsmilli14667 >gi|1057446207|gb|KU715776.1| Tintinnopsis ventricosoides isolate 58 small subunit ribosomal RNA gene, partial sequence
\f1\fs24 \

\f0\fs29\fsmilli14667 TCTCAAAGATAAGCCATGCATGTCTAAGTATAAATGGTATACAATGAAACTGCGAATGGCTCATTAAAACAGTTATAGTTTACTTGGTAATCAAACTTACATGGATAACCGTGGTAATTCTAGAG
\f1\fs24 \

\f0\fs29\fsmilli14667 >gi|1057446206|gb|KU715775.1| Tintinnopsis sp. isolate 60 small subunit ribosomal RNA gene, partial sequence
\f1\fs24 \

\f0\fs29\fsmilli14667 CATGTCTAAGTATAAATTGGTATACAATGAAACTGCGAATGGCTCATTAAAACCGTTAATGTTTATTTGGTAACCAAACTTACATGGATAACCGTGGTAATTCTAGAGCTAATACATGCTGTCA>gi|1057446205|gb|KU715774.1| Tintinnopsis radix isolate 101913 small subunit ribosomal RNA gene, partial sequence
\f1\fs24 \

\f0\fs29\fsmilli14667 AACCTGGTTGATCCTGCCAGTAGTCATACGCTTGTCTCAAAGATTAAGCCATGCATGTCTAAGTATAAATGGTATACAATGAAACTGCGAATGGCTCATTAAAACAGTTACAGTTTATTTGGTA
\f1\fs24 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\b\fs29\fsmilli14667 \cf6 \strokec6 Ask JD to modify the script if you use recent sequence download from GenBank as GenBank has changed the Fasta Format (no gi number and no bar between numbere.g. >KU715776.1 Tintinnopsis ventricosoides isolate 58 small subunit ribosomal RNA gene, partial sequence)
\f1\b0\fs24 \cf2 \strokec2 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \
\
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2 To run the script type Python Uniquify.py in terminal and follow the instruction (where is your file and what similarity you want to use).
\f1\fs24 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\b\fs29\fsmilli14667 \cf2 Step 1 of the script:
\f1\b0\fs24 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2 The script will rename your sequence as follow:
\f1\fs24 \

\f0\fs29\fsmilli14667 >Tintinnopsis_ventricosoides_KU715776.1
\f1\fs24 \

\f0\fs29\fsmilli14667 TCTCAAAGATAAGCCATGCATGTCTAAGTATAAATGGTATACAATGAAACTGCGAATGGCTCATTAAAACAGTTATAGTTTACTTGGTAATCAAACTTACATGGATAACCGTGGTAATTCTAGAG
\f1\fs24 \

\f0\fs29\fsmilli14667 >Tintinnopsis_sp._KU715775.1
\f1\fs24 \

\f0\fs29\fsmilli14667 CATGTCTAAGTATAAATTGGTATACAATGAAACTGCGAATGGCTCATTAAAACCGTTAATGTTTATTTGGTAACCAAACTTACATGGATAACCGTGGTAATTCTAGAGCTAATACATGCTGTCA
\f1\fs24 \

\f0\fs29\fsmilli14667 >Tintinnopsis_radix_KU715774.1
\f1\fs24 \

\f0\fs29\fsmilli14667 AACCTGGTTGATCCTGCCAGTAGTCATACGCTTGTCTCAAAGATTAAGCCATGCATGTCTAAGTATAAATGGTATACAATGAAACTGCGAATGGCTCATTAAAACAGTTACAGTTTATTTGGTA
\f1\fs24 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\b\fs29\fsmilli14667 \cf2 Step 2:
\f1\b0\fs24 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2 The script will align the sequence with 
\b MAFFT
\b0  and build a tree with 
\b FastTree
\b0 .
\f1\fs24 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\b\fs29\fsmilli14667 \cf2 Step 3: 
\f1\b0\fs24 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2 Based on the tree, the script will perform pairwise alignment with water, and keep sequences only with a similarity lower than your cutoff
\f1\fs24 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\b\fs29\fsmilli14667 \cf2 Step 4:
\f1\b0\fs24 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2  The script will add a the end of each sequence kept the number of sequence represented by this sequence (Tintinnopsis_ventricosoides_KU715776.1
\b _rid_58
\b0 )
\f1\fs24 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\b\fs29\fsmilli14667 \cf2 Step 5:
\f1\b0\fs24 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\fs29\fsmilli14667 \cf2 The script will perform an alignment of your uniquified sequence file with MAFFT and build a tree with FastTree.
\f1\fs24 \
\pard\pardeftab720\sl280\partightenfactor0
\cf2 \
\pard\pardeftab720\sl400\partightenfactor0

\f0\b\fs29\fsmilli14667 \cf2 Outputs:
\f1\b0\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl400\partightenfactor0
\ls2\ilvl0
\f0\i\fs29\fsmilli14667 \cf2 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 _rename.fas: 
\i0 your sequence file renamed
\i \uc0\u8232 \
\ls2\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 _rename_mafftout:
\i0 Alignment of your sequences renamed\uc0\u8232 \
\ls2\ilvl0
\i \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 _rename_FastTree.tree: 
\i0 Tree of your sequences renamed\uc0\u8232 \
\ls2\ilvl0
\i \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 _WhoRiddedWho.txt:
\i0\b  
\b0 a map the reference with the sequence ridded
\b \uc0\u8232 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl400\partightenfactor0
\ls2\ilvl0
\b0 \cf2 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 _
\i RiddedSeqs.fasta: 
\i0 your sequences file reduced\uc0\u8232 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sl400\partightenfactor0
\ls2\ilvl0
\i \cf2 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 _uniquified.fas:
\i0  your sequences file reduced with the number of ridded sequences\uc0\u8232 \
\ls2\ilvl0
\i \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 _uniquified_aligned.fas:
\i0  Alignment of the uniquified sequences\uc0\u8232 \
\ls2\ilvl0
\i \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 _uniquified.tree:
\i0 Tree of the uniquified sequences\uc0\u8232 \
}